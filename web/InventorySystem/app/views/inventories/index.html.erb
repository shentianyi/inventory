
<div id="dialog-overlay"></div><p id="notice"><%= notice %></p>
<script type="text/javascript">
    $(function () {
        data_upload("#item-data-uploader", 'xlsx');
    });
</script>
<h1>零件库位基础信息</h1>
<hr />
<div>
	<%= form_tag inventories_path, :method => 'get' do %>
		<p>
			<%= hidden_field_tag :search, value=true %>
			部门：<%= text_field_tag :department, params[:department]%>
          全盘员工号：<%= text_field_tag :check_user, params[:check_user]%>
          抽盘员工号：<%= text_field_tag :random_check_user, params[:random_check_user]%>
          库位号：从<%= text_field_tag :position_begin, params[:position_begin]%>到<%= text_field_tag :position_end, params[:position_end]%>
			零件号：<%= text_field_tag :part, params[:part]%>
			是否是iOS新建：<%= select_tag :ios_created_id, options_for_select([["否", 0],["是", 1]]), {prompt: '选择'} %>
			是否是抽盘：<%= select_tag :is_random_check,  options_for_select([["否", 0],["是", 1]]), {prompt: '选择'} %>
			显示方式:
			  <%= select_tag :format, options_for_select([["Web", "html"],["Excel File(MS 07 or later)", "xlsx"]], "html") %>
			<%= submit_tag "查询", :name => nil, class: 'btn btn-primary' %>
		</p>
	<% end%>
</div>
<div class="btn-group">
	<%= link_to '创建零件库存信息', new_inventory_path, class: 'btn btn-default' %>
	<a name="down_template" href="/files/download?folder=inventory&file=inventory_template.xlsx" class='btn btn-default' >下载模版</a>
<!--	<input id="item-data-uploader" type="file" name="files[]" data-url="/inventories/import"/>

    <div class="abstractblock" id="item-data-uploader-preview" style="display:none;"></div>-->
	<%= link_to '上传数据', import_inventories_path, class: 'btn btn-primary'  %>
	<%= link_to '盘点统计', root_path, class: 'btn btn-primary'  %>
	<%= link_to '生成抽盘数据', random_inventories_path, remote: true, :data => { :"disable-with" => "请稍等..." }, class: 'btn btn-primary'  %>
</div>

<div class="btn-group pull-right">

  <div class="page_info">
    <%= page_entries_info @inventories %>
  </div>
	<%= will_paginate @inventories, renderer: BootstrapPagination::Rails %>
</div>
<table class="table table-striped table-hover table-bordered" id="editable-sample">
  <thead>
    <tr>
	  <th>序号</th>
      <th>部门</th>
      <th>库位</th>
      <th>零件号</th>
      <th>零件类型</th>
      <th>全盘数量</th>
      <th>全盘员工</th>
      <th>全盘时间</th>
      <th>抽盘数量</th>
      <th>抽盘员工</th>
      <th>抽盘时间</th>
      <th>是否抽盘</th>
      <th>iOS新建id</th>
      <th colspan="3">管理</th>
    </tr>
  </thead>

  <tbody>
    <% @inventories.each_with_index do |inventory, index| %>
      <tr>
		<td><%= index+1 %></ed>
        <td><%= inventory.department %></td>
        <td><%= inventory.position %></td>
        <td><%= inventory.part %></td>
        <td><%= inventory.part_type %></td>
        <td><%= inventory.check_qty %></td>
        <td><%= inventory.check_user %></td>
        <td><%= inventory.check_time.strftime("%Y-%m-%d %H:%M:%S") if !inventory.check_time.nil?%></td>
        <td><%= inventory.random_check_qty %></td>
        <td><%= inventory.random_check_user %></td>
        <td><%= inventory.random_check_time.strftime("%Y-%m-%d %H:%M:%S") if !inventory.random_check_time.nil? %></td>
        <td><%= inventory.is_random_check %></td>
        <td><%= inventory.ios_created_id %></td>
        <td><%= link_to '详情', inventory %></td>
        <td><%= link_to '编辑', edit_inventory_path(inventory) %></td>
        <td><%= link_to '删除', inventory, method: :delete, data: { confirm: '是否删除该条记录?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<div class="pull-right">
<%= will_paginate @inventories, renderer: BootstrapPagination::Rails %>
</div>
<br>
